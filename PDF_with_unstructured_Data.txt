--- Page 1 ---
scIDPMs: single-cell RNA-seq imputation using diffusion probabilistic
models
Zhiqiang Zhang1{zhangzq2312@163.com}, Lin Liu∗12{liulinrachel@163.com}
March 1, 2024
Authors’ addresses
1Yunnan Normal University.
2the Computer Vision and Intelligent Control Technology Engineering Research Center under the Yunnan Provincial
Department of Education.
Abstract
Single-cell RNA sequencing (scRNA-seq) technology is a high-throughput sequencing analysis method that enables
the sequencing of mRNA in individual cells, thereby facilitating a more precise understanding of cellular gene ex-
pression and metabolic products. This approach reveals cell function and characteristics, making it widely applicable
in biological research. However, scRNA-seq data often suffers from false zero values known as dropout events due
to limitations in sequencing technology. These dropout events not only mask true gene expression levels but also
significantly impact downstream analysis accuracy and reliability. To address this challenge, numerous computational
approaches have been proposed for imputing missing gene expression values. Nevertheless, existing imputation meth-
ods struggle to fully capture the distribution of dropout values due to the high sparsity of scRNA-seq data and the
complexity and randomness associated with gene expression patterns. Recently, probabilistic diffusion models have
emerged as deep generative models capable of accurately restoring probability density distributions in domains such as
image and audio processing. In this paper, we propose a method called scIDPMs, which utilizes conditional diffusion
probabilistic models to impute scRNA-seq data. scIDPMs first identifies dropout sites based on the characteristics of
cellular gene expression and then infers the dropout values by conditioning on the available gene expression values,
which provide context information for the dropout values. To effectively capture the global features of gene expression
profiles, scIDPMs employs a deep neural network with an attention mechanism to optimize the objective function.
The performance of scIDPMs was evaluated using both simulated and real scRNA-seq datasets, and compared with
eight other imputation methods. The experimental results clearly demonstrated that, in comparison to alternative
approaches, scIDPMs exhibited exceptional performance in recovering biologically meaningful gene expression values
and enhancing various downstream analyses.
1
INTRODUCTION
As the fundamental unit of life, cells exhibit heterogeneity and complex interactions within biological systems. The
diversity of gene expression is a key factor contributing to the variation in cell morphology and function. While bulk
RNA-seq technology provides information on average gene expression levels across entire cellular subpopulations, it fails
to capture cellular heterogeneity.
In contrast, single-cell RNA sequencing (scRNA-seq) enables construction of gene
expression profiles for individual cells, providing a more precise understanding of gene expression at the single-cell level.
This technology presents new opportunities for exploring heterogeneity and functional differences within cell populations
and has been widely applied in fields such as cancer research, cell development, and immunology [1]. However, scRNA-seq
data contain numerous zero values due to both biological reasons (i.e., genes not expressed or expressed at low levels)
and limitations in sequencing technology (e.g., cDNA amplification deviation or insuﬀicient sequencing depth), resulting
in dropout events [2, 3].
These events pose significant challenges for downstream analysis tasks such as identifying
intercellular gene expression differences or characterizing cell types [4].
To tackle the issue of missing gene expression values resulting from dropout events, a range of methodologies have been
proposed, encompassing model-based and deep learning-based methods. Model-based methods utilize prior knowledge
such as existing gene expression values, cell relationships, and gene relationships to establish probabilistic models for
estimating missing values and uncovering gene expression patterns in single-cell transcriptomic data. For instance, kNN-
smoothing [5] updates the expression values of each cell by averaging the expression information from its K nearest
neighboring cells. MAGIC [6] constructs a similarity graph of cells and propagates gene expression information between
similar cells to infer missing values. SAVER [7] models sequencing data using a probabilistic approach and employs
Bayesian statistical inference for recovery purposes. Although these methods have achieved some success in imputing
scRNA-seq data, they tend to globally adjust the expression levels of all genes, potentially distorting true gene expressions
and introducing noise in downstream analysis - leading to an over-smooth problem where imputed data perform worse
than unimputed data. To tackle this issue, scImpute [8] first identifies dropout sites and then imputes dropout values
1
.
CC-BY-NC-ND 4.0 International license
made available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprint
this version posted March 4, 2024. 
; 
https://doi.org/10.1101/2024.02.29.582870
doi: 
bioRxiv preprint 


--- Page 2 ---
based on gene expression information from similar cells; however, it may also reduce random differences in gene expressions
between cells [9].
With the robust fitting capability of deep neural networks, an increasing number of deep learning-based imputation
methods for scRNA-seq data have been proposed. These methods primarily rely on specific neural network structures, such
as convolutional neural networks (CNN) [10] and graph neural networks (GNN) [11], to extract data features and restore
data distribution from latent space using generative models like AutoEncoders (AEs) [12], Variational Auto-Encoders
(VAEs) [13], and Generative Adversarial Networks (GANs) [14]. For instance, AutoImpute [15] employs VAEs to restore
the initial distribution of sparse matrices, while scIGANs [16] reshape individual cell expression profiles into images by
treating missing gene expression values as missing pixels and use GANs to recover the expression data. However, this
method faces limitations due to the limited receptive field of convolutional operations, making it challenging to capture
global data features. To address this issue, GNNImpute [17] utilizes graph attention network (GAT) to extract cell features
and employs AEs for reconstructing the expression matrix. SCDD [18] combines graph convolutional network (GCN)
with AEs to reduce noise introduced during imputation in order to alleviate over-smoothing problems. LSH-GAN [19]
applies locality sensitive hashing for sampling processed expression data and then trains GANs using the sampled data to
generate new samples, thereby addressing issues related to fewer cell samples in downstream analysis tasks. Additionally,
scGCC [20] leverages GAT for learning low-dimensional representations of the data while scGCL [21] combines graph
contrastive learning with AEs for imputing missing values. scGGAN [22] is a GANs model based on GCN. It initially
constructs a gene relation network using additional genomic sequencing data and subsequently utilizes this network, along
with the expression matrix of scRNA-seq, as training data to learn and restore the underlying distribution of the dataset.
Despite the evaluation conducted by Dai et al. [23] , which demonstrates superior performance of deep learning-based
imputation methods over model-based imputation approaches, there still exists potential for further enhancement.
Typically, scRNA-seq data contains gene expression information for thousands of genes across a large number of cells,
resulting in high dimensionality [24]. Moreover, scRNA-seq data is characterized by high sparsity and noise levels that are
influenced by various factors such as sequencing technology, environment, and physiological states. These features present
challenges for model-based imputation methods to accurately capture the underlying data distribution. Recently, diffusion
probabilistic models (DPMs) [25, 26], as a class of likelihood-based generative models, have emerged as the new state-
of-the-art family of deep generative models [27]. DPMs are capable of accurately restoring the ground-truth distribution
of target data on hidden variables with dimensions identical to those of the original data while maintaining diversity in
generated samples. Compared to other generative models such as VAEs and GANs, DPMs estimate target distributions
based on variational inference with a solid theoretical foundation, flexible model structure, and stable training process.
As a result, they achieve excellent performance in computer vision, natural language processing, multimodal learning and
other fields [28]. The existing deep learning-based methods employ various deep neural network models, such as CNN and
GNN, to partially extract local features from gene expression sequences; however, acquiring comprehensive global features
remains challenging. Simultaneously, advanced language models built upon the Transformer [29] architecture, such as
ChatGPT [30] and LaMDA [31] , have made remarkable strides in the field of natural language processing. These models
leverage deep neural networks that incorporate attention mechanisms to effectively capture long-range dependencies
within sequences. Inspired by Zheng et al. [32], who employed DPMs for the purpose of imputing missing values in
tabular data, this paper proposes scIDPMs, a framework based on conditional DPMs designed specifically for scRNA-seq
imputation (Figure 1). ScIDPMs constructs a conditional deep neural network model with attention mechanism based
on the powerful inference algorithm of DPMs to restore the distribution of complex target data, utilizing existing gene
expression values as conditions for inferring dropout value distributions. Specifically, scIDPMs identifies dropout sites
by referencing gene expression patterns in similar cells and employs a self-supervised training method to divide existing
gene expression values into conditional observation values and imputation targets.
These two sets are then used as
training data for optimizing the parameters of the conditional DPMs model with attention mechanism. Finally, the
trained conditional DPMs model takes existing gene expression values as conditional observations and gradually restores
the ground-truth distribution of dropout values through an inference algorithm based on DPMs.
Compared to existing imputation methods, scIDPMs possess several advantages.
Firstly, leveraging the inherent
strengths of DPMs inference algorithm, scIDPMs does not rely on a specific statistical model for the distribution of target
data. This allows it to better fit the distribution of dropout values. Secondly, scIDPMs exclusively imputes expression
values affected by dropout events without altering the original gene expression values and biological zeros. Consequently,
it avoids introducing additional noise in downstream analysis. Thirdly, scIDPMs employs a deep neural network model
with an attention mechanism to capture comprehensive context information from single-cell gene expression profiles. This
enables it to extract features more comprehensively from gene expression sequences. Lastly, unlike other methods that
require supplementary information such as corresponding bulk RNA-seq data or genome sequence data for imputation
purposes, scIDPMs can complete interpolation independently. In this study, we systematically evaluate the performance
of scIDPMs using simulated and real scRNA-seq datasets and compare it with eight other imputation methods. Our
experimental results demonstrate that scIDPMs exhibit significant advantages in restoring gene expression levels and
improving downstream tasks including cell clustering and differential expression analysis.
2
.
CC-BY-NC-ND 4.0 International license
made available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprint
this version posted March 4, 2024. 
; 
https://doi.org/10.1101/2024.02.29.582870
doi: 
bioRxiv preprint 


--- Page 3 ---
Preprocessed matrix
Raw count matrix
Cells
Genes
preprocessing
&
cluster
mark dropout sites 
cluster 1
cluster 2
cluster n
...
Marked matrix 
Noisy 
Conditional observation 
Imputation targets 
Marked matrix 
performing T-step denoising
I
Trained 
conditional DPMs
Imputed matrix 
Noisy 
noise 
added in 
time step 
Conditional observation 
Imputation targets 
Conditional DPMs
optimizing  parameters
Observed matrix 
Figure 1: Overview of scIDPMs for scRNA-seq data imputation. (A)Preprocessing the raw data and identifying dropout
sites based on intercellular relationships. (B)Constructing training datasets for conditional DPMs using existing gene
expression values. (C)Imputing dropout values by utilizing the trained conditional DPMs with existing gene expression
values as conditional inputs.
3
.
CC-BY-NC-ND 4.0 International license
made available under a
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is 
The copyright holder for this preprint
this version posted March 4, 2024. 
; 
https://doi.org/10.1101/2024.02.29.582870
doi: 
bioRxiv preprint 


